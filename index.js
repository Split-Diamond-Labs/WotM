function capitalizeFirst(string) {
  return string.charAt(0).toUpperCase() + string.slice(1);
}

function toggleDark() {
  const style = document.getElementsByClassName("body")[0].style;
  style.filter = style.filter == "invert(1)" ? "invert(0)" : "invert(1)";
}

function refresh() {
  document.getElementById("title").innerText = rooms[currentRoom].name;
  document.getElementById("description").innerHTML = rooms[currentRoom].description;
  
  let items = document.getElementById("items");
  
  items.innerHTML = "";
  
  let DOMString = `<h3 style='text-align: center;'>${rooms[currentRoom].name}</h3>`;
  
  for (const item in rooms[currentRoom].items) {
    DOMString += `<span style="font-size: 2.5vh; margin-left: 0.5vh;">${capitalizeFirst(rooms[currentRoom].items[item].name)}</span>
    <button style="padding-top: 0.2vw; padding-bottom: 0.2vw;" id="${item}" onclick='(function(e) { rooms[currentRoom].items["${item}"].onGrab(); inventory["${item}"] = rooms[currentRoom].items["${item}"]; delete rooms[currentRoom].items["${item}"]; refresh(); notify(\`You picked up the ${rooms[currentRoom].items[item].name}.\`); })(this)'>Take</button>
    <br>`;
  }

  items.innerHTML = DOMString;

  let items2 = document.getElementById("room-items");
  DOMString = "<h3 style='text-align: center;'>Inventory</h3>";
  
  for (const item in inventory) {
    DOMString += `<span style="font-size: 2.5vh; margin-left: 0.5vh;">${capitalizeFirst(inventory[item].name)}</span>
    <button style="padding-top: 0.2vw; padding-bottom: 0.2vw;" id="${item}" onclick='(function(e) { inventory["${item}"].onDrop(); rooms[currentRoom].items["${item}"] = inventory["${item}"]; delete inventory["${item}"]; refresh(); notify(\`You dropped your ${inventory[item].name}.\`); })(this)'>Drop</button>
    <button style="padding-top: 0.2vw; padding-bottom: 0.2vw;" id="${item}use" onclick='(function(e) { inventory["${item}"].onUse(); refresh(); })(this)'>Use</button>
    <br>`;
  }
  
  items2.innerHTML = DOMString;

  let items3 = document.getElementById("exits");
  DOMString = "";
  
  for (const path in rooms[currentRoom].exits) {
    DOMString += `
    <button id=${path} onclick="exit('${path}')">Go ${path}${rooms[currentRoom].exits[path].locked ? " (locked)" : ""}</button>`;
  }
  
  items3.innerHTML = DOMString;
}

function notify(message) {
  document.getElementById("notify").innerText = message;
  document.getElementById("notify").style.backgroundColor = "black";
  document.getElementById("notify").style.color = "white";
  setTimeout(() =>  { document.getElementById("notify").style.backgroundColor = "white"; document.getElementById("notify").style.color = "black"; }, 500);
}



function exit (direction) {
  if (!rooms[currentRoom].exits[direction]) return;
  if (rooms[currentRoom].exits[direction].locked) {
    notify("That way is locked.");
    return;
  }
  currentRoom = rooms[currentRoom].exits[direction].to;
  notify(`You went ${direction}...`);
  refresh();
};

let currentRoom = "forest";

let inventory = {
  
};

let handsome = `
...........................................................................,,*(#%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%#(/*,......................................................................
.................................................................,,*/((#%&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%##(/*,,............................................................
.............................................................,/#%&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%#/,........................................................
......................................................,,*/(%&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%#(**,.................................................
...................................................*(%&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%%#((///////******//////((##%%&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&%(*..............................................
..............................................,/(#&&@@@@@@@@@@@@@@@@@@@&&&&%%##((//*,,,,,,,,,,,,,,,********************/////((##%%%&&&&@@@@@@@@@@@@@@@@@@&&%(/,.........................................
...........................................,/%&&@@@@@@@@@@@@@@@@@@@@&&%(/********,,,...........,...,,*****************/////******/////(#%&&@@@@@@@@@@@@@@@@@@&&%(*......................................
.......................................,/#%&@@@@@@@@@@@@@@@@@&&%##(/***************,,................,*******,**,*****//////////*//*******/((#%&&&@@@@@@@@@@@@@@@&%#/,..................................
....................................,*#&&@@@@@@@@@@@@@@@@&&%/*,,*********************,..............,,*****,,,*****,*****///////*///***,,*******/(#&&@@@@@@@@@@@@@@@&&%/,...............................
.................................,/(%&@@@@@@@@@@@@@@@&%#(/,,,,***///////////////////*****,,,,,,,,,,,,,,*************,,,**********////****/******//***/(#%&@@@@@@@@@@@@@&%#/,............................
.............................../#&&@@@@@@@@@@@@@@&&%#(////////////////////////////////////*******,,,,,,,*******,,,,,,,,,,***,...,,**//**////***//**..    ,(%&@@@@@@@@@@@@@&&#/..........................
...........................,*(%&@@@@@@@@@@@@@@&%#(////////******,,,.,,......,,,,,,,,*****,,,,,,,,,,,,,,,,,,,,,,,,******,,,,,,........,,**////////**,.      .,/#&&@@@@@@@@@@@@&&(*,......................
........................../#&&@@@@@@@@@@@@@@%/*,,**/////****,,,,,.................,,,,,,,,,,,,,,,,,,,,,,,,,,,,*********,,,,,,..........,**/////////*,.        ../#&@@@@@@@@@@@@&&%/.....................
.......................,/%&@@@@@@@@@@@@@&%(*....,**//*********////////////******,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,********,,**,,,,,,**************////*,..         .,/(%&@@@@@@@@@@@@&%(*..................
.....................*/%&@@@@@@@@@@@@@&#*.   ...,,***,........,*************,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,*******************////************//**,.          ..,,*(%&@@@@@@@@@@@&%(*................
...................,/%&@@@@@@@@@@@@&%(,.     ....,,,,....... ..,********,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,****************///////*************/***,.         .......,/#&@@@@@@@@@@@&%(*..............
.................,(%&@@@@@@@@@@@@@%/,.       .....,,,......  ..,,******,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,*******************////*****///////****,..         ...,,.   .*(&@@@@@@@@@@@&%(,............
................/#&@@@@@@@@@@@@&%/,,....       .................,,,,***,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,*******************/*//**********,,,......         ...,,,.     .*(&&@@@@@@@@@@&%/,..........
..............*#&@@@@@@@@@@@@&%/..,,,,......       ......      .,,,*,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,******************////***,,,.....                 ...,,**,.      .,(&&@@@@@@@@@@&#*.........
............,/%&@@@@@@@@@@@&%(,.  .,,,,,......         ........,,,***,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,*********************///**,..                      ...,,***,.        .*#&@@@@@@@@@@@%(,.......
...........*#&@@@@@@@@@@@@%#,     .,,**,,......         ..,,,*******,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,**************************/////*,..                    ...,,****,.          ./&&@@@@@@@@@@&#/......
.........,*#@@@@@@@@@@@@&%/.       .,****,,,....      ...,,*******,,,,,,,,,,,,,,,,,,,,,,......,,,,,***************************////////*,.                 ....,**///*,.           .,(&&@@@@@@@@@@%/,....
........,/&&@@@@@@@@@@&&(..        .,*///**,,,...  ....,,,*************,,,,,,,,,,,,,,,..     .,,,,,***************************//////////*,,,.           ....,,*////*,.              .*%&@@@@@@@@@&&(,...
.......,(%@@@@@@@@@@@&%/,          .,**/////**,,,,,,,,,*****************,,,,,,,,,,*,,,..     .,,,,****************************//////////*,,..         ....,,*//((//,.                .*(&@@@@@@@@@@%#*..
......*(&@@@@@@@@@@@@#/.            .,***//////*******************************,*,**,,,..    ..,,,*****************************//////////*,,,.        ...,,*//(((/*,.                   ,#%@@@@@@@@@@&(*.
.....,(&&@@@@@@@@@@&%*              .,***,.,**/(//////*****************************,,,,.....,,,*******************************///////////**,...  ....,,**//((((/*..                     .(&&@@@@@@@@&&#,
....*(%@@@@@@@@@@&&#.               .,**,.  .,*((((///*****************************,,,,,,,,,,,******************************//////////////***,,..,,,,**//((((/*,.                        ./%@@@@@@@@@@%(
...,/&&@@@@@@@@@@&#*                 .,,.   .,*/((//***********************************************************************///////////////////*****///(((((*,.                            ,(%&@@@@@@@@&&
..,/%@@@@@@@@@@@&%,                   ..    .,,*************************************************************************////////////////((((((((((((((((/*,.                              .*(&@@@@@@@@@@
..*#&@@@@@@@@@@@#*.                         .,*///********************************************************************//////////////////((((((######(/,.                                 ...*#&@@@@@@@@@
.,/%@@@@@@@@@@@&/                       .  .,**////////**************************,,,,,,*********************************////////////////((((((#####(/..                              ..,,,,..,#@@@@@@@@@
./%&@@@@@@@@@@&#*                         .,*//**/////////****///****************************************************************/////////////((((((*.                           ..,,,,,,,,.  /&&@@@@@@@
.(&&@@@@@@@@@@%*.                         .,*///////////******/////////********/////*///***/*//////////////////////////////////////////(((((((((###(*..                    ..,..,,,***,.,,,.  ,(%@@@@@@@
*#@@@@@@@@@@@&#*,,..                       .,/(#(((/////////////////////*******/////////////*****//////////////////////////((((((((((((((###########/,.                    .,,,,,,,,,,,,,,,.  .,%@@@@@@@
/%@@@@@@@@@@&%(*,,,.                       .,/(((((/////((##((///////////(((((///////////////**/////////////////***////((((((((((////(((######((((##(*,.                    ,,*,,.......,,,.   .#&@@@@@@
#%@@@@@@@@@@&#/,,,,.                       .,//((((((////(((///////////(((##(((////////////((((((((////////////////((((((((((((((////((#######((((###(*..                   .,*,,,,,,..,,,,.   .(%&@@@@@
%&@@@@@@@@@@&/*,,,..                         .*/(##((((((((((//////////////////////////////(((#((((//////////(((#####((((((((((((##############%%%#(/*.                     .,*,,,,,,,,,,,,.   ./%&@@@@@
%&@@@@@@@@@@&/,,,,..                           .,*/(######(((((((((((((((((((((((((((((////(/((((/(((((((((((((((((((((((((((###############%%%%%%(*..                       .*****,,,,,,,..   .*#&@@@@@
&&@@@@@@@@@@&/,,,,.                              .*(###(/**,*****////((((((((((((((((((((((((((((((((((((((((((((((((((################%%%%%%%%%%#(,..                       .*********,,,,.   .*#&@@@@@
&&@@@@@@@@@@&/,,,,..       ...                   .,/###(/*,,,,,**///((####((((///////////((((((##############################%%%%%%%%%%%%%%%%%%##/*.                         .,******,,,,,,.    *#&@@@@@
@@@@@@@@@@@@%/,,,,...   ...,,,.    ...        ...,*(###(/,,,,**/(((((((((((((((///**********///(((##%%##########((((((((((((((((###%%%%&&&%%#(*,,.                           ..,******,,,..     *#&@@@@@
@@@@@@@@@@@@&/*,,,....,,,,,,,,.    ....       .,,,*(%%#(*,,**//(((((((##%%%%###(//***,,,***///(((#######%%&&&%#####((/////*****//(%%%%&&&&%%(/,.                              .,*,,,...         *#&@@@@@
@@@@@@@@@@@@&/*,,...,,**,,,,,,.   .....       .,,,*(%%#/*,***///((###%%%%%%####(//***,,***////(((####(((#####(((((((((////******/(#%%%%%%%###(/*.                               .              .*#&@@@@@
@@@@@@@@@@@@&(*,,. .,,*,,,,.,,.   ...,.       ...,*(%%#/*,,**//(((((//(((((((((//*********/////((((((((//////////////////*******/(#%%%%%##(((((*,.                                             ./#&@@@@@
@@@@@@@@@@@@&(/,,. .,,,,,.....,.  ..,,.       ...,*(%%#/*,,**////*****//////////**********//////////////////////////************/(#%%%##(////((/,.                                             .(%&@@@@@
@@@@@@@@@@@@&#/... ..,,,,,.. ...  ..,,.          ,/(##(/*,***********//////**********,****///////////***//////******************//#%%%#(//*//((/,.                                             .#&&@@@@@
@@@@@@@@@@@@&%/     .,,,,,,........,..           ,/(##(/*,,***,********************,,,,***///////////****************************/#%%%##(//*///*..                                             .#&@@@@@@
@@@@@@@@@@@@@@(     .,,,,,,,....,,,,..           .*/(#(/*,,,,,,,,,,**************,,,,,,***/////////******************************/(###(#((/*//*,     .                                        .*%@@@@@@@
@@@@@@@@@@@@@@%*.    ,*,,,,,,...,,,..            .*//((/*,,,,,,,,,,************************///////////////***********************////((((////*..     .                                        *#&@@@@@@@
@@@@@@@@@@@@@@&%*    .*,,,,,,,,,,,,.             .,**/***,,,,,,,,,,***********************/////**//////((/////*******************///////////*.                                                (&&@@@@@@@
@@@@@@@@@@@@@@@&/.   .,,,,,,,,,,,..               .,*****,,,,,,,,*****/////////////***/////(((((((((((((((((//////***************/////**//*,.                                               .*#@@@@@@@@@
@@@@@@@@@@@@@@@@%/.  .,,,,,,,,,,..                 .,,****,,,,*****///(((//////((((/////(((((((((((((((////(((////////////*******/////***,.                                                 *#&@@@@@@@@@
@@@@@@@@@@@@@@@@&%*.  ..    ....                    .,,*********////(((///***//////((((((((((((((((((//////////(((//////////*****////**,..                ..,*///((((////*,.              .*#&@@@@@@@@@@
@@@@@@@@@@@@@@@@@&%/                                  .,,******///(((////*****/////((((((((((((((((((///////((((/((//////////////////*,.          ....*/%&@@@@@@@@@@@@@@@@@@@&#/,.        ,#&@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@&#*.                                 .,*****///(((/////******/////////////////////////////(((/////////////////////*,           ,/#%&&@@@@@@@@@@@@@@@@@@@@@@@@@&&%(*.   ,(%@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@&&/                                  .*****///((////////////////////((((((((((((((((((((#(((/////////////////////*.       .,/%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#/,(&@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@%(.                                .******////////((#%%%%##(((((/((((((((/(((##%%&%%%##(//////////////////////**.     .*#&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@&/,                               .,*********///////(##%%##((////////(((/(######((///////////////////////////*,.....*#&@@@@@@@@@@@@@&&&&%%######%%%&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@&&#*.                              .,******************/////////((((((((((((////////////////////////////////**,.. ,(%@@@@@@@@@@@&&%%#(((((((((((((((((#%&&@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@&&(.                              .,*****//////***********///////////////////////////////////////////////**,   *(&@@@@@@@@@@&&#((((((((((((((((((((((((#%&@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@&%*.                              .,**////////**********/////////////////////////(((((////////////////***, ..#&&@@@@@@@@&&%((((((((((((((((((((((((((((#%&&@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#,.                             .,*//////////********/////////////////////////(((((((/////////////***/*,*/%@@@@@@@@@&%((((((((((((((((((((((((((((((((#&@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&#*,.                            .,*/////////**********/////////////////////((((((((/////////////**/((*(%&@@@@@@@@&%#(((((((((((((((((((((((((((((((((%&&@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&(*          .......,,,........ ..,*///////*****************/////**/////((((((((((////////////**///*.(@@@@@@@@@@&%#(((((((((((((((((((((((((((((((((#&&@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#*.             .......  ..,,,,,,***////******************/////////(((((((((((((((((((///////*,...(@@@@@@@@@@&#((((((((((((((((((((((((((((((((((#&&@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%*.                        ...,,,**/////***********/////////////(((((((((((((((((((/////**,.....(@@@@@@@@@@&%#(((((((((((((((((((((((((((((((((#&&@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%(*.. .                        .,,*/////////////////////((((((((((((((####((((((////**,......./%&@@@@@@@@&%#(((((((((((((((((((((((((((((((((%&&@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&(,...........              ...,**/((((((((((((((((((((((((((########((((((((//*,..........,(%@@@@@@@@@&%((((((((((((((((((((((((((((((((#&@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#/*..........              .,****//(((((((####((((((((((#######((((((((//*,,.............,#&&@@@@@@@@&&%((((((((((((((((((((((((((((#%&&@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%(,.........          ....,,****////((((((((((((((((((((((((((((((/,,..................*(&@@@@@@@@@@&&#(((((((((((((((((((((((((%&@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%#/*..         .......,********//////////(((((((((((((((((//*,,......................,(%@@@@@@@@@@@&&%%#(((((((((((((((((#%&&@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&#/,   .  .......,*/**,*****////////////////((((((//*,,............................*#&@@@@@@@@@@@@@&&&&%%######%%%&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%#/*,........,*///*,,****///////////////////*,,.................................,/#&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&%(*,...,,*//**,,,*************////**,....................................*/#&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%#((/((/*,,,,***************,..............................,,*/(##%&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&%#(//*************,......................,*/(#%&&&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
`;
console.log(`ACKNOWLEDGEMENTS

Thanks to everyone who helped us dev this, especially Mikey, who introduced me to React.js (even though we didn't use it for this game). He also helped us by being extremely handsome :)
${handsome}

I'd also like to thank Spinz and XVO, also from Split Diamond Labs, for helping me through the tough times of lockdown by not doing much work and making me happy instead. 

Finally, I'd like to thank all of my family, friends and teachers, who helped guide me and the rest of the team through this game. 

Well, see you all in WotM II: SpeckCoin Incremental!

- Flyspeck101
`);

if (localStorage.getItem("darkMode")) toggleDark();
if (localStorage.getItem("inventory")) inventory = JSON.parse(localStorage.getItem("inventory"));
if (localStorage.getItem("rooms")) rooms = JSON.parse(localStorage.getItem("rooms"));
if (localStorage.getItem("currentRoom")) currentRoom = localStorage.getItem("currentRoom");

setInterval(() => {
  localStorage.setItem("darkMode", document.getElementsByClassName("body")[0].style.filter == "invert(1)");
  localStorage.setItem("inventory", JSON.stringify(inventory));
  localStorage.setItem("rooms", JSON.stringify(rooms));
  localStorage.setItem("currentRoom", currentRoom);
}, 10000);

refresh();